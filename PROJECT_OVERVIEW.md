# SimpleOS é¡¹ç›®æ¦‚è§ˆ

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
cos/
â”œâ”€â”€ ğŸ“„ README.md                  # è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ QUICKSTART.md             # å¿«é€Ÿå¯åŠ¨æŒ‡å— â­ ä»è¿™é‡Œå¼€å§‹
â”œâ”€â”€ ğŸ“„ WINDOWS_SETUP.md          # Windows è¯¦ç»†è®¾ç½®
â”œâ”€â”€ ğŸ“„ Makefile                  # æ„å»ºé…ç½®
â”‚
â”œâ”€â”€ ğŸ”§ build.ps1                 # PowerShell æ„å»ºåŠ©æ‰‹
â”œâ”€â”€ ğŸ“ setup.sh                  # WSL è‡ªåŠ¨è®¾ç½®è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ boot/
â”‚   â””â”€â”€ boot.asm                 # 512 å­—èŠ‚å¼•å¯¼åŠ è½½ç¨‹åº
â”‚
â”œâ”€â”€ ğŸ“ kernel/
â”‚   â”œâ”€â”€ kernel.c                 # C è¯­è¨€å†…æ ¸ä»£ç 
â”‚   â”œâ”€â”€ kernel.h                 # å†…æ ¸å¤´æ–‡ä»¶
â”‚   â””â”€â”€ kernel_entry.asm         # 32 ä½å†…æ ¸å…¥å£
â”‚
â”œâ”€â”€ ğŸ“ src/                      # å…¶ä»–æºæ–‡ä»¶
â”œâ”€â”€ ğŸ“ build/                    # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â””â”€â”€ os.img                   # å¯å¯åŠ¨ç£ç›˜é•œåƒ (è¿è¡Œåç”Ÿæˆ)
â”‚
â””â”€â”€ ğŸ“ .vscode/
    â”œâ”€â”€ tasks.json               # VS Code ä»»åŠ¡é…ç½®
    â””â”€â”€ settings.json            # ç¼–è¾‘å™¨è®¾ç½®
```

## ğŸ¯ é¡¹ç›®åŠŸèƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SimpleOS å¯åŠ¨æµç¨‹              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£  BIOS åŠ è½½å¼•å¯¼åŠ è½½ç¨‹åº (0x7C00)
    â†“
2ï¸âƒ£  boot.asm æ‰§è¡Œ
    - æ‰“å°æ¬¢è¿ä¿¡æ¯
    - ä»ç£ç›˜åŠ è½½å†…æ ¸
    - è¿›å…¥ä¿æŠ¤æ¨¡å¼
    â†“
3ï¸âƒ£  kernel_entry.asm æ‰§è¡Œ (0x1000)
    - è®¾ç½®å †æ ˆ
    - è°ƒç”¨ C å‡½æ•°
    â†“
4ï¸âƒ£  kernel.c æ‰§è¡Œ
    - æ¸…é™¤å±å¹•
    - è®¾ç½® VGA æ˜¾ç¤º
    - è¾“å‡ºæ¬¢è¿ä¿¡æ¯
    â†“
5ï¸âƒ£  æ— é™å¾ªç¯ (HLT æŒ‡ä»¤)
```

## ğŸ› ï¸ æ„å»ºå·¥å…·é“¾

| å·¥å…· | ç”¨é€” | å¹³å° |
|-----|------|------|
| **NASM** | æ±‡ç¼–å¼•å¯¼åŠ è½½ç¨‹åº | Linux/WSL |
| **i686-elf-gcc** | ç¼–è¯‘ 32 ä½å†…æ ¸ | Linux/WSL |
| **i686-elf-ld** | é“¾æ¥å†…æ ¸ç›®æ ‡æ–‡ä»¶ | Linux/WSL |
| **QEMU** | x86 æ¨¡æ‹Ÿå™¨ | Linux/WSL/Windows |
| **Make** | æ„å»ºè‡ªåŠ¨åŒ– | Linux/WSL |
| **GDB** | è°ƒè¯•å™¨ | Linux/WSL |

## ğŸ“‹ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### åœ¨ Windows PowerShell ä¸­

```powershell
# ä½¿ç”¨æ„å»ºåŠ©æ‰‹
.\build.ps1 build          # ç¼–è¯‘
.\build.ps1 run            # ç¼–è¯‘å¹¶è¿è¡Œ
.\build.ps1 debug          # å¯åŠ¨è°ƒè¯•
.\build.ps1 wsl            # æ‰“å¼€ WSL
.\build.ps1 clean          # æ¸…ç†
```

### åœ¨ WSL ç»ˆç«¯ä¸­

```bash
# å¯¼èˆªåˆ°é¡¹ç›®
cd /mnt/c/Users/mfanq/OneDrive/Desktop/cos

# åŸºæœ¬å‘½ä»¤
make clean                 # æ¸…ç†
make all                   # ç¼–è¯‘
make run                   # è¿è¡Œ
make debug                 # è°ƒè¯•

# æˆ–ä½¿ç”¨ä¸€é”®è„šæœ¬
bash setup.sh             # è‡ªåŠ¨è®¾ç½®å’Œè¿è¡Œ
```

## ğŸš€ å¯åŠ¨æ–¹å¼

### æ–¹å¼ 1: æœ€ç®€å• (WSL)

```bash
cd /mnt/c/Users/mfanq/OneDrive/Desktop/cos
bash setup.sh
```

### æ–¹å¼ 2: æ‰‹åŠ¨ç¼–è¯‘

```bash
cd /mnt/c/Users/mfanq/OneDrive/Desktop/cos
make clean
make all
make run
```

### æ–¹å¼ 3: ç›´æ¥ QEMU

```bash
qemu-system-i386 -fda build/os.img -m 128M
```

## ğŸ“Š æ–‡ä»¶è¯´æ˜

### å¼•å¯¼åŠ è½½ç¨‹åº (`boot/boot.asm`)
- å¤§å°: 512 å­—èŠ‚ (å¿…é¡»)
- åŠ è½½åœ°å€: 0x7C00
- åŠŸèƒ½:
  - åˆå§‹åŒ–æ®µå¯„å­˜å™¨
  - ä»ç£ç›˜åŠ è½½å†…æ ¸
  - åˆ‡æ¢åˆ°ä¿æŠ¤æ¨¡å¼
  - è·³è½¬åˆ° 0x1000

### å†…æ ¸ (`kernel/kernel.c`)
- å®é™…å†…æ ¸ä»£ç 
- VGA æ˜¾ç¤ºé©±åŠ¨ç¨‹åº
- å­—ç¬¦è¾“å‡ºå‡½æ•° `kputs()`
- å±å¹•æ¸…é™¤å‡½æ•° `clear_screen()`

### å†…æ ¸å…¥å£ (`kernel/kernel_entry.asm`)
- 32 ä½ä¿æŠ¤æ¨¡å¼ä»£ç 
- è®¾ç½®å †æ ˆæŒ‡é’ˆ
- è°ƒç”¨ C ä¸»å‡½æ•°

## ğŸ”„ æ„å»ºè¿‡ç¨‹

```
æºæ–‡ä»¶                 ç¼–è¯‘å·¥å…·              ç›®æ ‡æ–‡ä»¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ boot.asm     â”‚â”€â”€â”€â†’  â”‚ NASM  â”‚ â”€â”€â”€â†’ â”‚ build/boot.bin â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚kernel_entry  â”‚â”€â”€â”€â†’  â”‚ NASM   â”‚ â”€â”€â”€â†’ â”‚kernel_entry.o   â”‚
â”‚.asm          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
                                              â†“
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ é“¾æ¥ (LD)    â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ kernel.c     â”‚â”€â”€â”€â†’  â”‚ i686-  â”‚ â”€â”€â”€â”       â†“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ elf-   â”‚    â”œâ”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ gcc    â”‚ â”€â”€â”€â”¤     â”‚ kernel.elf  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â””â”€â”€â†’ kernel.bin (objcopy)

æœ€ç»ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ boot.bin    â”‚â”        â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”œâ”€â”€â”€â”€â”€â”€â†’ â”‚ os.img   â”‚ (å¯å¯åŠ¨ç£ç›˜é•œåƒ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚        â”‚ (floppy) â”‚
â”‚ kernel.bin  â”‚â”˜        â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“š èµ„æºé“¾æ¥

- [OSDev Wiki](https://wiki.osdev.org/) - OS å¼€å‘èµ„æº
- [GCC äº¤å‰ç¼–è¯‘](https://wiki.osdev.org/GCC_Cross-Compiler) - å·¥å…·é“¾æŒ‡å—
- [x86 æ¶æ„](https://wiki.osdev.org/X86) - å¤„ç†å™¨è¯´æ˜
- [QEMU æ–‡æ¡£](https://qemu.readthedocs.io/) - æ¨¡æ‹Ÿå™¨æŒ‡å—

## âš™ï¸ å¸¸è§å®šåˆ¶

### å¢åŠ å†…å­˜
ç¼–è¾‘ Makefile ä¸­çš„ QEMU å‚æ•°:
```makefile
run: $(OS_IMG)
	$(QEMU) -fda $< -m 256M  # æ”¹ä¸º 256M
```

### æ”¹å˜åŠ è½½åœ°å€
ç¼–è¾‘ `kernel/kernel_entry.asm` ä¸­çš„åœ°å€å¸¸é‡å’Œ Makefile ä¸­çš„ LDFLAGSã€‚

### æ·»åŠ é©±åŠ¨ç¨‹åº
åœ¨ `kernel/` ä¸­åˆ›å»ºæ–°çš„ .c æ–‡ä»¶ï¼Œå¹¶åœ¨ Makefile ä¸­æ·»åŠ ç¼–è¯‘è§„åˆ™ã€‚

## ğŸ› å¸¸è§é—®é¢˜

**Q: ç¼–è¯‘å¤±è´¥ "i686-elf-gcc not found"**
A: åœ¨ WSL ä¸­è¿è¡Œ: `sudo apt-get install gcc-i686-linux-gnu`

**Q: QEMU æ— æ³•å¯åŠ¨**
A: ç¡®ä¿ build/os.img å­˜åœ¨ï¼Œè¿è¡Œ `make clean && make all`

**Q: å±å¹•æ˜¾ç¤ºä¹±ç **
A: æ£€æŸ¥ VGA å†…å­˜åœ°å€ (0xB8000) å’Œé¢œè‰²å€¼

**Q: å¦‚ä½•è°ƒè¯•?**
A: è¿è¡Œ `make debug`ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­è¿æ¥ GDB

## ğŸ“ ä¸‹ä¸€æ­¥

1. âœ… ç¼–è¯‘å’Œè¿è¡ŒåŸºç¡€ OS
2. ğŸ¯ æ·»åŠ é”®ç›˜ä¸­æ–­å¤„ç†
3. ğŸ¯ å®ç°å†…å­˜ç®¡ç† (åˆ†é¡µ)
4. ğŸ¯ å®ç°è¿›ç¨‹è°ƒåº¦
5. ğŸ¯ æ·»åŠ æ–‡ä»¶ç³»ç»Ÿ
6. ğŸ¯ åˆ›å»º shell å‘½ä»¤è¡Œ

---

**æœ€åæ›´æ–°**: 2025-11-23
**ç‰ˆæœ¬**: 1.0.0
**ä½œè€…**: SimpleOS å›¢é˜Ÿ
